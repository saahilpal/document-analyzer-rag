# ==========================================
# Document-Analyzer-RAG Environment Config
# ==========================================

# --- Server Configuration ---
# The port the Node.js Express server will listen on
PORT=4000
# The host binding. 0.0.0.0 allows external traffic (e.g., from Cloudflare Tunnels)
HOST=0.0.0.0
# development | production
NODE_ENV=development
# Set to 'true' if running behind a reverse proxy (like Nginx or Cloudflare Tunnels) to parse real IPs for rate-limiting
TRUST_PROXY=false
# Comma-separated list of allowed CORS origins for the frontend clients
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# --- File Uploads ---
# Maximum allowed PDF upload size in bytes (Default: 52428800 = 50MB)
MAX_UPLOAD_FILE_SIZE_BYTES=52428800

# --- Google Gemini AI Configuration ---
# Required: Your live Gemini API Key
GEMINI_API_KEY=your_gemini_api_key_here
# The generation model to use. Defaults to gemini-2.5-flash
GEMINI_MODEL=gemini-2.5-flash

# --- RAG (Retrieval-Augmented Generation) Settings ---
# How many top vector chunks to inject into the LLM context prompt
RAG_TOP_K=5
# Pagination ceiling over SQLite chunks during Cosine Similarity searches
RAG_CANDIDATE_PAGE_SIZE=400
# Maximum number of recent chat messages returned per session context loop
RAG_HISTORY_LIMIT=12
# Estimated ratio of characters per text token (Used for PDF text splitting)
RAG_TOKEN_TO_CHAR_RATIO=4
# Max tokens per index chunk for Xenova local embeddings
RAG_CHUNK_TOKENS=1000
# Overlap buffer tokens between chunks to prevent context cliff drops
RAG_CHUNK_OVERLAP_TOKENS=200

# --- Local Embedding Pipeline ---
# Batching size for Xenova Transformers running in-memory
LOCAL_EMBEDDING_BATCH_SIZE=24
LOCAL_EMBEDDING_BATCH_SIZE_MIN=8
LOCAL_EMBEDDING_BATCH_SIZE_MAX=64

# --- Worker Cleanup Settings ---
# Polling interval for the background cleanup service in ms
CLEANUP_INTERVAL_MS=900000
# How long (hours) to keep completed successful background indexing jobs
CLEANUP_COMPLETED_JOB_TTL_HOURS=24
# How long (hours) to keep failed or halted jobs before pruning
CLEANUP_FAILED_JOB_TTL_HOURS=72
# How long (hours) to keep temporary disk uploads that failed to fully index
CLEANUP_TEMP_FILE_TTL_HOURS=6

# --- SMTP Email Configuration ---
# Required to send OTP password resets and user registration success emails
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
# The authenticated username (e.g. Gmail address)
SMTP_USER=your_email@gmail.com
# Use an App Password if using Gmail, never your raw root password
SMTP_PASS=your_smtp_app_password
# The branded From address alias users will see
SMTP_FROM='"DocAnalyzer" <your_email@gmail.com>'
